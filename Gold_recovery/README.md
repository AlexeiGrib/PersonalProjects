# Описание проекта "Восстановление золота из золотосодержащей руды".

## Цель проекта: 
 обучить модель, которая должна предсказать уровень восстановления золота из золотосодержащей руды. 

## Задачи проекта:

1. Подготовка данных.

2. Анализ данных.

3. Моделирование.

## Инструменты:

1. pandas
2. numpy
3. sklearn.mean_absolute_error 
4. sklearn.make_scorer
5. sklearn.RandomForestRegressor
6. sklearn.DecisionTreeRegressor
7. sklearn.LinearRegression
8. sklearn.RandomizedSearchCV
9. sklearn.parallel_backend
10. matplotlib

## Основные результаты проекта:

1. Импортированы необходимые библиотеки, а также считан наборы данных, проведён небольшой исследовательский анализ, осуществлена предобработка: 
- Тренировочная и тестовая выборки содержат информацию о различных аспектах каждого из 4 этапов техпроцесса получения золота из руды. При этом в обоих выборках присутствуют пропущенные значения и дублирующиеся объекты.
- Ручная проверка корректности расчёта эффективности обогащения на этапе флотации показала, что расчётное и приведённое в выборке значение эффективности обогащения отличается друг от друга незначительно, о чём говорит крайне низкое значение метрики MAE. Для ручного определения эффективности обогащения была написана соответствующая функция, принимающая на вход строку в наборе данных и возвращающая значение эффективности обогащения. Применялась функция на тренировочной выборке.
- Количество признаков в тренировочной и тестовой выборках не соответствует друг другу: в тренировочной выборке хранится 86 признаков, в то время как в тестовой выборке хранилось лишь 52 признака. Также было сказано, что в тестовой выборке отсутствовали целевые признаки, предскзаание которых являлось целью проекта. Признаки были синхронизированы друг с другом за счёт, во-первых, удаления из тренировочной выборки признаков, которых нет в тестовой выборке, так как очевидно, что в тестовой выборке содержатся те данные, которые будут у нас в наличии при промышленной эксплуатации модели, и, во-вторых, в тестовую выборку из полного набора данных были добавлены целевые признаки.
- В ходе предварительной обработки данных из выборок были удалены дубликаты, а пропущенные значения были заменены на схожие с соседними признаками значения, так как в соответствии с условиями задачи признаки, находящиеся рядом друг с другом по временному признаку, несильно отличаются. Для этого был использован метод fillna, его параметру method было передано значение ffill, которое подходит для обработки пропущенных значений в таких случаях.
2. проведён анализ имеющихся данных для выявления аномальных значений и сравненительного анализа распределений концентрации металлов (в том числе суммарной) на различных этапах техпроцесса:
- Как суммарное, так и одиночное распределение концентрации металлов на различных стадиях техпроцесса демонстрирует одну и ту же тенденцию: по мере прохождения стадий техпроцесса в распределении концентрации металлов изменятся плотность распределения, а также два его основных параметра - среднее значение и дисперсия. В случае, например, с Au по мере прохождения стадий техпроцесса его концентрация увеличивается от флотации к финальной стадии. В случае с Ag ситуация обратная: концентрация этого металла небольшая на этапе флотации, но увеличивается по мере приближения к финальной стадии. В целом же суммарная концентрация всех металлов увеличивается по мере прохождения стадий техпроцесса.
- Распределение концентрации металлов - как индивидуальная, так и суммарная - на различных стадиях техпроцесса похоже на нормальное, однако на графике гладкого распределения видна вторая мода в нулевой точке, из-за чего распределение становится бимодальным и не может считаться нормальным. Справедливо будет предположить, что в редких случаях концентрация металлов может быть нулевой на первичной стадии обработки. Поэтому аномальные значения с нулевой концентрацией металлов были удалены из набора данных.
- Распределение размеров гранул сырья почти не отличаются в тестовой и тренировочной выборках, следовательно, модель не будет давать смещённые предсказания - данные можно использовать для моделирования.
3. Написана функция для расчёта итогового sMAPE, определены основные типы моделей, которые планировалось использовать, подобраны оптимальные гиперпараметры методом RandomizedSearchCV для определёных ранее моделей, построены и протестированы на тестовых данных модели с лучшими значениями гиперпараметров, результаты их работы были сравнены с константной псевдомоделью. В результате удалось построить модели, обеспечивающее итоговое sMAPE в размере 11.7700 при sMAPE в размере 12.0099 на константой псевдомодели, из чего был сделан вывод об адекватности модели и валидности результатов её работы.
