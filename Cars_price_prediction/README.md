# Описание проекта "Предсказание цен на машины".

## Цель проекта: 
построить модель бустинга для предсказания стоимости подержанного автомобиля, основываясь на различных параметрах, характиризующих различные свойства описываемого автомобиля. 
 
 ## Критерии сравнения моделей:

- качество предсказания;

- скорость предсказания;

- время обучения.
 
## Задачи проекта:

1. Импорт библиотек, считывание набора данных и его первиный анализ.

2. Предобработка данных.

3. Построение моделей, выбор оптимальной модели.

## Инструменты:

1. pandas
2. numpy
3. LGBMRegressor
4. CatBoostRegressor
5. sklearn.GridSearchCV
6. sklearn.train_test_split
7. sklearn.mean_squared_error
8. sklearn.make_scorer
9. time
10. seaborn
11. matplotlib

## Основные результаты проекта:

1. Импортированы необходимые для работы библиотеки, считан исходный набор данных, а также проведён его предварительный анализ.
2. Проведена предобработка данных по следующим направлениям: удалены дубликаты и пропуски, сгенерированы новые признаки. Удалены признаки с датой, на основе которых были сгенерированы новые признаки, а также удалён аномальный признак NumberOfPictures, единственным уникальным значением которого был 0.
3. Построены модели, основанные на алгоритмах CatBoost и LightGBM, при этом CatBoost был использован из коробки, а для LightGBM подобран оптимальный набор гиперпараметров с использованием GridSearchCV. Сравнительные результаты результатов модели:

|Алгоритм |RMSE, евро |Скорость обучения, сек. |Скорость предсказания, сек. |
|:--------|:----------|:-----------------------|:---------------------------|
|LightGBM |1632.89	  |4.24                    |0.44                        |
|CatBoos  |1704.61	  |130.43                  |0.22                        |

В результате CatBoost из коробки обеспечил RMSE на уровне 1704.61 евро на отложенной выборке, в то время как затюненный LightGBM обеспечивает RMSE на уровне 1632.89 евро. При этом LightGBM из коробки намного хуже предсказывает цену на автомобили, чем CatBoost: LightGBM из коробки обеспечивает RMSE на уровне 1737.97 евро.

При этом LightGBM обучается значительно быстрее CatBoost (4.24 секунды против 130.43 секунды соответственно), но немногим дольше прогнозирует цену (0.44 секунд для LightGBM против 0.22 секнуд для CatBoost).

Рекомендуется использовать настроенный LightGBM с 800 итерациями и долями признаков/объектов в размере 0.70 от исходного размера со скоростью обучения 0.11 и 51 листом на дереве, который, во-первых, обучается существенно быстрее, чем его товарищ CatBoost, во-вторых, обеспечивает более точное предсказание цены на автомобили: разница между точностью предсказания составляет порядка 71,72 евро в пользу LightGBM. Затраты времени на предсказание примерно одинаковы и отличаются несущественно. У CatBoost в рамках данной задачи нет существенных преимуществ перед LightGBM, так как оба алгоритма умеют работать с категориальными признаками. Минусом LightGBM является необходимость подбора гиперпараметров, что в рамках данной задачи потребовало 43 минуты, однако это нужно сделать один раз перед обучением модели, поэтому при выводе модели в промышленное использование этот минус нивелируется.
