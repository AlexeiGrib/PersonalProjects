# Описание проекта "Отток клиентов".

## Цель проекта: 
 спрогнозировать, уйдёт клиент из банка в ближайшее время или нет - требуется построить модель с предельно большим значением F1-меры. 
 
## Критерий успешности проекта:
значение F1-меры не менее 0.59. 

## Задачи проекта:

1. Импорт необходимых библиотек, чтение набора данных, его первичный анализ.

2. Исследование данных и их подготовка к моделированию.

3. Моделирование.

## Инструменты:

1. pandas
2. numpy
3. sklearn.train_test_split
4. sklearn.StandardScaler
5. sklearn.shuffle
6. sklearn.RandomForestClassifier
7. sklearn.DecisionTreeClassifier
8. sklearn.LogisticRegression
9. sklearn.f1_score
10. sklearn.precision_score
11. sklearn.recall_score
12. sklearn.roc_auc_score
13. sklearn.roc_curve
14. sklearn.confusion_matrix
15. random
16. matplotlib

## Основные результаты проекта:

1. Импортированы необходимые для работы библиотеки, считан исходный набор данных, а также проведён его предварительный анализ.
2. Проведено исследование данных и их подготовка к моделированию:
- удаление лишних признаков;
- преобразование категориальных признаков в дамми-признаки;
- проведение анализ зависимостей между признаками;
- разделение набора данных на тренировочную, валидационную и тестовую части;
- масштабирование количественных признаков;
- балансировка классов.
3. Исследованы модели, основанные на различных алгоритмах машинного обучения - логистической регрессии, дерева решений и случайного леса, для каждой посчитаны метрики F1-мера и ROC-AUC. Также была отобрана лучшая по значению F1-меры модель, которая была проанализирована более основательно.

Ключевые результаты:

|Алгоритм/Балансировка классов |Дисбаланс классов                |Взвешивание классов              |Upsampling                       |Downsampling                    |
| :----------------------------|:--------------------------------|:--------------------------------|:--------------------------------|:-------------------------------|
|Логистическая регрессия       |F1 мера: 0.3018, ROC-AUC: 0.7589 |F1 мера: 0.5046, ROC-AUC: 0.7646 |F1 мера: 0.4992, ROC-AUC: 0.7678 |F1 мера: 0.5029, ROC-AUC: 0.7651|
|Дерево решений                |F1 мера: 0.5565, ROC-AUC: 0.7589 |F1 мера: 0.5934, ROC-AUC: 0.8191 |F1 мера: 0.5857, ROC-AUC: 0.8184 |F1 мера: 0.5903, ROC-AUC: 0.8191|
|Случайный лес                 |F1 мера: 0.5147, ROC-AUC: 0.8649 |F1 мера: 0.6358, ROC-AUC: 0.8646 |F1 мера: 0.6119, ROC-AUC: 0.8627 |F1 мера: 0.6165, ROC-AUC: 0.8663|

Лучшая модель была проанализиована подробно, результаты исследования:

1. F1-мера для построенной модели сложилась на уровне 0.6358, что соответствует значению целевой метрики не менее 0.59, установленному условиями проекта.


2. Построенная модель прошла тест на адекватность: случайная и константная модели обеспечивают худшее значение F1-меры (0.2893 и 0.3519 соответственно), чем построенная модель (0.6358).


3. Исходя из анализа матрицы ошибок, можно заключить, модель предсказывает класс 1 не так хорошо, как класс 0. Это находит своё отражение в том, что модель совершает больше ошибок первого рода (предсказывая уход клиента тогда, когда он в действительно сохраняется), чем ошибок второго рода (предсказывая сохранение клиента, в то время как в действительности клиент уходит).


4. Метрика recall сложилась на уровне 0.74. Следовательно, из всех действительно ушедших клиентов, которых модель смогла определить корректно, а также тех клиентов, которые ушли и которых модель определить не смогла, совершив ошибку второго рода (TP + FN, что составляет 427 клиентов), модель смогла правильно определить только около 74%, что является довольно неплохим результатом.


5. Метрика precision сложилась на уровне 0.5573. Следовательно, из всех действительно ушедших клиентов, которых модель смогла определить, а также среди тех клиентов, которые на самом деле не ушли и уход которых модель предсказала, совершив ошибку первого рода (TP + FP, что составляет 567 клиента), модель смогла правильно определить около 56%. Относительно неплохое значение метрики обусловленно небольшим количеством ошибок первого рода - модель не очень хорошо предсказывает уход клиента, поэтому ложно отметила сохранённых клиентов как ушедших.


6. Модель реже ошибается в предсказании ухода клиента (небольшое количество клиентов было отмечено как сохранённые, однако в действительности они ушли, т.е больше ошибок второго рода), чем в предсказании сохранения клиента (большее количество клиентов было отмечено как ушедшие, которые в действительности остались в банке, т.е. больше ошибок первого рода). 


7. Метрика TPR сложилась на уровне 0.74. Следовательно, в 74% случаев построенная модель будет успешно предсказывать объекты с классом 1 (уход клиента), что кажется довольно приятным результатом.


8. Метрика FPR сложилась на уровне 0.1596. Следовательно, только в 16% случаев построенная модель может ошибаться, предсказывая сохранение клиента. Следовательно, в 84% случаев модель успешно предскажет сохранение клиента.


9. Построенная модель обеспечитвает более высокое значение метрики ROC-AUC, чем случайный классификатор.


10. Так как значение метрики ROC-AUC для построенной модели выше 0.50 (сложилось на уровне 0.8646), можно говорить о том, что построенная модель обеспечивает лучшее по сравнению со случайным классификатором значение метрик TPR и FPR и в целом предсказывает уход клиентов достаточно хорошо, так как допускает не слишком много много ошибок первого и второго рода.
